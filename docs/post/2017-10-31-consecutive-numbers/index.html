<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.30.2" />
  <meta name="author" content="Tim Trice">

  
  
  
  
    
      
    
  
  <meta name="description" content="Given a table of integers we are asked to find consecutive integers, specifically those that occur on at least three straight occurences. Those integers are then returned. This query uses CASE WHEN with variables and is very similar to the Rank Scores problem.
">

  
  <link rel="alternate" hreflang="en-us" href="../../post/2017-10-31-consecutive-numbers/">

  


  

  
  
  <meta name="theme-color" content="#795548">
  
  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">
  
  
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="../../styles.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-1507390-26', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  
  <link rel="alternate" href="../../index.xml" type="application/rss+xml" title="Tim Trice">
  <link rel="feed" href="../../index.xml" type="application/rss+xml" title="Tim Trice">
  

  <link rel="manifest" href="../../site.webmanifest">
  <link rel="icon" type="image/png" href="../../img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="../../img/icon-192.png">

  <link rel="canonical" href="../../post/2017-10-31-consecutive-numbers/">

  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@https://twitter.com/timtrice">
  <meta property="twitter:creator" content="@https://twitter.com/timtrice">
  
  <meta property="og:site_name" content="Tim Trice">
  <meta property="og:url" content="/post/2017-10-31-consecutive-numbers/">
  <meta property="og:title" content="Consecutive Numbers | Tim Trice">
  <meta property="og:description" content="Given a table of integers we are asked to find consecutive integers, specifically those that occur on at least three straight occurences. Those integers are then returned. This query uses CASE WHEN with variables and is very similar to the Rank Scores problem.
">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2017-10-31T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2017-10-31T00:00:00&#43;00:00">
  

  

  <title>Consecutive Numbers - Tim Trice</title>

</head>
<body id="top" data-spy="scroll" data-target="#toc" data-offset="71" >

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="../../">Tim Trice</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      
      <ul class="nav navbar-nav navbar-right">
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="../../#about">
            
            <span>About</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="../../#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="../../#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

        
        
        
        
        
          
        

        <li class="nav-item">
          <a href="../../#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        
      

      
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Consecutive Numbers</h1>

    

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2017-10-31 00:00:00 &#43;0000 UTC" itemprop="datePublished dateModified">
      Oct 31, 2017
    </time>
  </span>
  <span itemscope itemprop="author publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Tim Trice">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    3 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="../../post/2017-10-31-consecutive-numbers/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="../../categories/sql">SQL</a
    >, 
    
    <a href="../../categories/leetcode">LeetCode</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Consecutive%20Numbers&amp;url=%2fpost%2f2017-10-31-consecutive-numbers%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2f2017-10-31-consecutive-numbers%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2f2017-10-31-consecutive-numbers%2f&amp;title=Consecutive%20Numbers"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2f2017-10-31-consecutive-numbers%2f&amp;title=Consecutive%20Numbers"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Consecutive%20Numbers&amp;body=%2fpost%2f2017-10-31-consecutive-numbers%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>


    <div class="article-style" itemprop="articleBody">
      <p>Write a SQL query to find all numbers that appear at least three times consecutively.</p>
<pre><code>+----+-----+
| Id | Num |
+----+-----+
| 1  |  1  |
| 2  |  1  |
| 3  |  1  |
| 4  |  2  |
| 5  |  1  |
| 6  |  2  |
| 7  |  2  |
+----+-----+</code></pre>
<p>For example, given the above <code>Logs</code> table, <em>1</em> is the only number that appears consecutively for at least three times.</p>
<pre><code>+-----------------+
| ConsecutiveNums |
+-----------------+
| 1               |
+-----------------+</code></pre>
<div id="table-setup" class="section level3">
<h3>Table Setup</h3>
<pre class="sql"><code>CREATE DATABASE IF NOT EXISTS `LeetCode`;</code></pre>
<pre class="sql"><code>USE `LeetCode`;</code></pre>
<pre class="sql"><code>CREATE TABLE IF NOT EXISTS `Logs` (
  `Id` INT, 
  `Num` INT
);</code></pre>
<pre class="sql"><code>TRUNCATE TABLE `Logs`;</code></pre>
<pre class="sql"><code>INSERT INTO `Logs`
  (`Id`, `Num`)
VALUES 
  (1, 1), 
  (2, 1), 
  (3, 1), 
  (4, 2), 
  (5, 1), 
  (6, 2), 
  (7, 2);</code></pre>
</div>
<div id="example-data" class="section level3">
<h3>Example Data</h3>
<pre class="sql"><code>SHOW COLUMNS IN `Logs`;</code></pre>
<div class="knitsql-table">
<table>
<caption><span id="tab:explain-tables">Table 1: </span>2 records</caption>
<thead>
<tr class="header">
<th align="left">Field</th>
<th align="left">Type</th>
<th align="left">Null</th>
<th align="left">Key</th>
<th align="left">Default</th>
<th align="left">Extra</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Id</td>
<td align="left">int(11)</td>
<td align="left">YES</td>
<td align="left"></td>
<td align="left">NA</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Num</td>
<td align="left">int(11)</td>
<td align="left">YES</td>
<td align="left"></td>
<td align="left">NA</td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
<pre class="sql"><code>SELECT * 
FROM `Logs`;</code></pre>
<div class="knitsql-table">
<table>
<caption><span id="tab:select-tables">Table 2: </span>7 records</caption>
<thead>
<tr class="header">
<th align="left">Id</th>
<th align="right">Num</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="solution" class="section level3">
<h3>Solution</h3>
<pre class="sql"><code>SET @prev_num = 0;</code></pre>
<pre class="sql"><code>SET @counter = 0;</code></pre>
<pre class="sql"><code>SELECT 
  *, 
  CASE 
    WHEN @prev_num != `Num` THEN @counter := 1 AND @prev_num := `Num`
    WHEN @prev_num = `Num` THEN @counter := @counter + 1
  END AS `con_num`
FROM `Logs`;</code></pre>
<div class="knitsql-table">
<table>
<caption><span id="tab:solution">Table 3: </span>7 records</caption>
<thead>
<tr class="header">
<th align="left">Id</th>
<th align="right">Num</th>
<th align="right">con_num</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="explanation" class="section level3">
<h3>Explanation</h3>
<p>This solution is very similar to the <a href="lc_mysql_rank_scores.html">Rank Scores</a> problem. The difference is that problem kept a continuous count throughout the column. This problem requires the counter be reset when a new number is encountered.</p>
<p>It is not mentioned in the original problem but <code>Num</code> returned must be <strong>DISTINCT</strong>.</p>
<p>My original solution passed the first test but failed on a subsequent test:</p>
<pre class="sql"><code>SET @prev_num = NULL;
SET @counter = 0;

SELECT
  `Num` AS `ConsecutiveNums`
FROM (
  SELECT
    `Num`, 
    CASE 
      WHEN @prev_num = `Num` THEN @counter := @counter + 1
      ELSE @counter := 1 
    END AS `con_num`, 
    @prev_num := `Num` AS `prev_num` 
  FROM `Logs`) AS `t`
WHERE `con_num` &gt;= 3;</code></pre>
<p>The particular table it failed on looked like this:</p>
<pre><code>+----+-----+
| Id | Num |
+----+-----+
| 1  |  1  |
| 2  |  0  |
| 3  |  0  |
| 4  |  0  |
+----+-----+</code></pre>
<p>The query started the count at <span class="math inline">\(0\)</span> instead of <span class="math inline">\(1\)</span> as it did in the original table. This threw off the count and returned an empty result set. Just an adjustment of the <strong>CASE</strong> statement and <code>prev_num</code> assignment resolved this.</p>
</div>
<div id="cleanup" class="section level3">
<h3>Cleanup</h3>
<pre class="sql"><code>DROP TABLE `Logs`;</code></pre>
</div>
<div id="mariadb-server-info" class="section level3">
<h3>MariaDB Server Info</h3>
<pre class="sql"><code>SELECT @@version_comment AS `Version`, 
  @@version_compile_machine AS `Version Compile Machine`, 
  @@innodb_version AS `InnoDB Version`, 
  @@version_compile_os AS `Version Compile OS`;</code></pre>
<div class="knitsql-table">
<table>
<caption><span id="tab:mariadb-version">Table 4: </span>MariaDB Server Info</caption>
<thead>
<tr class="header">
<th align="left">Version</th>
<th align="left">Version Compile Machine</th>
<th align="left">InnoDB Version</th>
<th align="left">Version Compile OS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">mariadb.org binary distribution</td>
<td align="left">x86_64</td>
<td align="left">5.7.20</td>
<td align="left">debian-linux-gnu</td>
</tr>
</tbody>
</table>
</div>
</div>

    </div>

    


<div class="article-tags">
  
  <a class="btn btn-primary btn-outline" href="../../tags/sql">SQL</a>
  
  <a class="btn btn-primary btn-outline" href="../../tags/leetcode">LeetCode</a>
  
</div>




    
    
    <div class="article-widget">
      <div class="hr-light"></div>
      <h3>Related</h3>
      <ul>
        
        <li><a href="../../post/2017-10-24-rank-scores/">Rank Scores</a></li>
        
        <li><a href="../../post/2017-10-17-nth-highest-salary/">Second Highest Salary</a></li>
        
        <li><a href="../../post/2017-10-10-combine-two-tables/">Combine Two Tables</a></li>
        
      </ul>
    </div>
    

    
    <div class="article-widget">
      <div class="post-nav">
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="../../post/2017-11-06-employees-earn-more-than-managers/" rel="next">Employees Earning More Than Their Managers</a>
  </div>
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="../../post/2017-10-24-rank-scores/" rel="prev">Rank Scores</a>
  </div>
  
</div>

    </div>
    

    
<section id="comments">
  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "timtrice" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



  </div>
</article>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2018 &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    <script id="dsq-count-scr" src="//timtrice.disqus.com/count.js" async></script>
    

    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>
    
    
    <script src="../../js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

