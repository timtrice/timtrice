---
title: Tropical Cyclone Time Over Land
author: ~
date: '2017-08-28'
slug: tropical-cyclone-time-over-land
categories: []
tags: []
---



<p>A question was posted earlier wondering the longest time a cyclone had spent over land. Using <a href="https://github.com/timtrice/HURDAT">HURDAT</a> we can calculate this.</p>
<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(HURDAT)
library(rnaturalearthdata)
library(sp)</code></pre>
<p>The dataset for Atlantic cyclones dates back to 1851. Using the <a href="https://github.com/ropenscilabs/rnaturalearthdata">rnaturalearthdata</a> package in conjunction with <code>HURDAT::AL</code>, we identify Lat/Lon points within <code>AL</code> that are within the <code>map_units50</code> polygon shapefile.</p>
<p>Additionally, we want to filter on records where <code>Status</code> is either “TD” (Tropical Depression), “TS” (Tropical Storm) or “HU” (Hurricane).</p>
<p>Observations are six hours apart so <code>Days.Over.Land</code> is divided by 4.</p>
<pre class="r"><code># Load data
data(AL)
data(map_units50)

# Filter AL on Status
AL &lt;- AL %&gt;% filter(Status %in% c(&quot;TD&quot;, &quot;TS&quot;, &quot;HU&quot;))

# Correct for some bad Lon values
AL$Lon &lt;- if_else(AL$Lon &lt; -180, 360 + AL$Lon, AL$Lon)

# Manipulate AL to use sp::over
coordinates(AL) &lt;- c(&quot;Lon&quot;, &quot;Lat&quot;)

proj4string(AL) &lt;- proj4string(map_units50)

AL$Over.Land &lt;- !is.na(over(AL, as(map_units50, &quot;SpatialPolygons&quot;)))

# Move back to dataframe
AL &lt;- as.data.frame(AL)

# Count sequential values and disregard NA&#39;s
AL$n &lt;- sequence(rle(as.character(AL$Over.Land))$lengths)/4
AL$n[!AL$Over.Land] &lt;- NA</code></pre>
<pre class="r"><code>AL %&gt;% 
  group_by(Key) %&gt;% 
  arrange(desc(n)) %&gt;% 
  filter(!is.na(n)) %&gt;% 
  summarise(Name = first(Name), 
            Days.Over.Land = first(n)) %&gt;% 
  top_n(20L) %&gt;% 
  arrange(desc(Days.Over.Land)) %&gt;% 
  knitr::kable()</code></pre>
<pre><code>## Selecting by Days.Over.Land</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Key</th>
<th align="left">Name</th>
<th align="right">Days.Over.Land</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AL021939</td>
<td align="left">UNNAMED</td>
<td align="right">6.50</td>
</tr>
<tr class="even">
<td align="left">AL021916</td>
<td align="left">UNNAMED</td>
<td align="right">5.25</td>
</tr>
<tr class="odd">
<td align="left">AL051997</td>
<td align="left">DANNY</td>
<td align="right">5.00</td>
</tr>
<tr class="even">
<td align="left">AL011960</td>
<td align="left">UNNAMED</td>
<td align="right">4.75</td>
</tr>
<tr class="odd">
<td align="left">AL061979</td>
<td align="left">CLAUDETTE</td>
<td align="right">4.75</td>
</tr>
<tr class="even">
<td align="left">AL011896</td>
<td align="left">UNNAMED</td>
<td align="right">4.50</td>
</tr>
<tr class="odd">
<td align="left">AL031987</td>
<td align="left">UNNAMED</td>
<td align="right">4.50</td>
</tr>
<tr class="even">
<td align="left">AL011968</td>
<td align="left">ABBY</td>
<td align="right">4.25</td>
</tr>
<tr class="odd">
<td align="left">AL011994</td>
<td align="left">ALBERTO</td>
<td align="right">4.25</td>
</tr>
<tr class="even">
<td align="left">AL012001</td>
<td align="left">ALLISON</td>
<td align="right">4.00</td>
</tr>
<tr class="odd">
<td align="left">AL071977</td>
<td align="left">CLARA</td>
<td align="right">4.00</td>
</tr>
<tr class="even">
<td align="left">AL011921</td>
<td align="left">UNNAMED</td>
<td align="right">3.75</td>
</tr>
<tr class="odd">
<td align="left">AL041979</td>
<td align="left">BOB</td>
<td align="right">3.75</td>
</tr>
<tr class="even">
<td align="left">AL051950</td>
<td align="left">EASY</td>
<td align="right">3.75</td>
</tr>
<tr class="odd">
<td align="left">AL061885</td>
<td align="left">UNNAMED</td>
<td align="right">3.75</td>
</tr>
<tr class="even">
<td align="left">AL061964</td>
<td align="left">DORA</td>
<td align="right">3.75</td>
</tr>
<tr class="odd">
<td align="left">AL061977</td>
<td align="left">BABE</td>
<td align="right">3.75</td>
</tr>
<tr class="even">
<td align="left">AL062008</td>
<td align="left">FAY</td>
<td align="right">3.75</td>
</tr>
<tr class="odd">
<td align="left">AL071898</td>
<td align="left">UNNAMED</td>
<td align="right">3.75</td>
</tr>
<tr class="even">
<td align="left">AL011926</td>
<td align="left">UNNAMED</td>
<td align="right">3.50</td>
</tr>
<tr class="odd">
<td align="left">AL041874</td>
<td align="left">UNNAMED</td>
<td align="right">3.50</td>
</tr>
<tr class="even">
<td align="left">AL051888</td>
<td align="left">UNNAMED</td>
<td align="right">3.50</td>
</tr>
<tr class="odd">
<td align="left">AL131998</td>
<td align="left">MITCH</td>
<td align="right">3.50</td>
</tr>
</tbody>
</table>
